module exposes mkO, A, B

struct O
    var payload: int32
end

function mkO () returns O
    return {payload = 0}
end

activity A (i: O)(o: int32)
    repeat
        o = i.payload
        await true
    end
end

activity B (i: int32)(o: O)
    repeat 
        o.payload = o.payload + i
        await true
    end
end